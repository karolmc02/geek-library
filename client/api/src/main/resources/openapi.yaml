openapi: 3.0.4
info:
  title: Geek Library Client API
  description: API definition for Geek Library client
  version: 1.0.0
  contact:
    name: Geek Library Support
    email: support@geeklibrary.com
servers:
  - url: http://localhost:8080/api
tags:
  - name: works
    description: Operations related to works in the Geek Library
  - name: editions
    description: Operations related to editions of works
  - name: volumes
    description: Operations related to volumes of editions
paths:
  /works/previews:
    post:
      summary: Create work preview from URL
      operationId: createWorkPreview
      description: Extract and preview work data with its editions and volumes from an external URL. This endpoint scrapes the provided URL and returns a preview of the extracted data for review and completion before saving. Fields may be incomplete or empty.
      tags:
        - works
      requestBody:
        description: URL to extract work data from
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                  description: External URL to extract work data from
                  example: https://example.com/manga/one-piece
              required:
                - url
      responses:
        '200':
          description: Work preview created successfully. Fields may be incomplete or empty and should be reviewed before saving.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/work'
        '400':
          description: Bad request - Invalid URL or unable to extract content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '422':
          description: Unprocessable Entity - URL is valid but content cannot be extracted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
  /works:
    get:
      summary: Query works
      operationId: queryWorks
      description: Retrieve a list of works from the Geek Library client API.
      tags:
        - works
      parameters:
        - name: title
          in: query
          description: Title of the work to search for
          required: false
          schema:
            type: string
        - name: author
          in: query
          description: Author of the work to search for
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  works:
                    type: array
                    items:
                      $ref: '#/components/schemas/work'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    post:
      summary: Create a new work
      operationId: createWork
      description: Create a new work in the Geek Library client API.
      tags:
        - works
      requestBody:
        description: Work object to be created
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/work'
      responses:
        '201':
          description: Work created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/work'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
  /works/{workId}:
    get:
      summary: Get work by ID
      operationId: getWorkById
      description: Retrieve a specific work by its ID from the Geek Library client API.
      tags:
        - works
      parameters:
        - $ref: '#/components/parameters/workId'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/work'
        '404':
          description: Work not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    put:
      summary: Update work by ID
      operationId: updateWorkById
      description: Update a specific work by its ID in the Geek Library client API.
      tags:
        - works
      parameters:
        - $ref: '#/components/parameters/workId'
      requestBody:
        description: Work object with updated information
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/work'
      responses:
        '200':
          description: Work updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/work'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '404':
          description: Work not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    delete:
      summary: Delete work by ID
      operationId: deleteWorkById
      description: Delete a specific work by its ID from the Geek Library client API.
      tags:
        - works
      parameters:
        - $ref: '#/components/parameters/workId'
      responses:
        '204':
          description: Work deleted successfully
        '404':
          description: Work not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
  /works/{workId}/editions:
    get:
      summary: Get all editions for a work
      operationId: getEditionsByWorkId
      description: Retrieve all editions of a specific work from the Geek Library.
      tags:
        - editions
      parameters:
        - $ref: '#/components/parameters/workId'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  editions:
                    type: array
                    items:
                      $ref: '#/components/schemas/edition'
        '404':
          description: Work not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    post:
      summary: Create a new edition for a work
      operationId: createEdition
      description: Create a new edition for a specific work in the Geek Library.
      tags:
        - editions
      parameters:
        - $ref: '#/components/parameters/workId'
      requestBody:
        description: Edition object to be created
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/edition'
      responses:
        '201':
          description: Edition created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/edition'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '404':
          description: Work not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
  /works/{workId}/editions/{editionId}:
    get:
      summary: Get edition by ID
      operationId: getEditionById
      description: Retrieve a specific edition by its ID for a given work.
      tags:
        - editions
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/edition'
        '404':
          description: Work or Edition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    put:
      summary: Update edition by ID
      operationId: updateEditionById
      description: Update a specific edition by its ID for a given work.
      tags:
        - editions
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
      requestBody:
        description: Edition object with updated information
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/edition'
      responses:
        '200':
          description: Edition updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/edition'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '404':
          description: Work or Edition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    delete:
      summary: Delete edition by ID
      operationId: deleteEditionById
      description: Delete a specific edition by its ID from a work.
      tags:
        - editions
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
      responses:
        '204':
          description: Edition deleted successfully
        '404':
          description: Work or Edition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
  /works/{workId}/editions/{editionId}/volumes:
    get:
      summary: Get all volumes for an edition
      operationId: getVolumesByEditionId
      description: Retrieve all volumes of a specific edition from the Geek Library.
      tags:
        - volumes
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  volumes:
                    type: array
                    items:
                      $ref: '#/components/schemas/volume'
        '404':
          description: Work or Edition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    post:
      summary: Create a new volume for an edition
      operationId: createVolume
      description: Create a new volume for a specific edition in the Geek Library.
      tags:
        - volumes
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
      requestBody:
        description: Volume object to be created
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/volume'
      responses:
        '201':
          description: Volume created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/volume'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '404':
          description: Work or Edition not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
  /works/{workId}/editions/{editionId}/volumes/{volumeId}:
    get:
      summary: Get volume by ID
      operationId: getVolumeById
      description: Retrieve a specific volume by its ID for a given edition.
      tags:
        - volumes
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
        - $ref: '#/components/parameters/volumeId'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/volume'
        '404':
          description: Work, Edition or Volume not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    put:
      summary: Update volume by ID
      operationId: updateVolumeById
      description: Update a specific volume by its ID for a given edition.
      tags:
        - volumes
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
        - $ref: '#/components/parameters/volumeId'
      requestBody:
        description: Volume object with updated information
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/volume'
      responses:
        '200':
          description: Volume updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/volume'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '404':
          description: Work, Edition or Volume not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
    delete:
      summary: Delete volume by ID
      operationId: deleteVolumeById
      description: Delete a specific volume by its ID from an edition.
      tags:
        - volumes
      parameters:
        - $ref: '#/components/parameters/workId'
        - $ref: '#/components/parameters/editionId'
        - $ref: '#/components/parameters/volumeId'
      responses:
        '204':
          description: Volume deleted successfully
        '404':
          description: Work, Edition or Volume not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/error'
components:
  parameters:
    workId:
      name: workId
      in: path
      description: ID of the work
      required: true
      schema:
        type: string
        format: uuid
    editionId:
      name: editionId
      in: path
      description: ID of the edition
      required: true
      schema:
        type: string
        format: uuid
    volumeId:
      name: volumeId
      in: path
      description: ID of the volume
      required: true
      schema:
        type: string
        format: uuid
  schemas:
    workType:
      type: string
      enum:
        - MANGA
        - ARTBOOK
        - LIGHT_NOVEL
    colorMode:
      type: string
      enum:
        - BLACK_AND_WHITE
        - FULL_COLOR
        - PARTIAL_COLOR
    language:
      type: object
      properties:
        isoCode:
          type: string
          description: ISO 639 language code
          example: en
      required:
        - isoCode
    country:
      type: object
      properties:
        isoCode:
          type: string
          description: ISO 3166 country code
          example: US
      required:
        - isoCode
    format:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          description: Format name
          example: Tankobon
        description:
          type: string
          description: Format description
          example: Standard Japanese manga format
        widthCm:
          type: number
          format: double
          description: Width in centimeters
          example: 11.5
        heightCm:
          type: number
          format: double
          description: Height in centimeters
          example: 17.5
      required:
        - name
        - widthCm
        - heightCm
    money:
      type: object
      properties:
        currency:
          type: string
          description: Currency code (ISO 4217)
          example: USD
        amount:
          type: number
          format: double
          description: Monetary amount
          example: 9.99
      required:
        - currency
        - amount
    volume:
      type: object
      description: Volume information
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
          description: Volume title
          example: Chapter 1 - The Beginning
        number:
          type: integer
          description: Volume number
          example: 1
        price:
          $ref: '#/components/schemas/money'
        publicationDate:
          type: string
          format: date
          description: Publication date
          example: 2024-01-15
        isbn:
          type: string
          description: ISBN number
          example: 978-1-4215-1234-5
        pages:
          type: integer
          description: Number of pages
          example: 192
    edition:
      type: object
      description: Edition information
      properties:
        id:
          type: string
          format: uuid
        publisher:
          type: string
          description: Publisher name
          example: Viz Media
        language:
          $ref: '#/components/schemas/language'
        country:
          $ref: '#/components/schemas/country'
        isOriginal:
          type: boolean
          description: Whether this is the original edition
          example: false
        format:
          $ref: '#/components/schemas/format'
        colorMode:
          $ref: '#/components/schemas/colorMode'
        volumes:
          type: array
          items:
            $ref: '#/components/schemas/volume'
    work:
      type: object
      description: Work information
      properties:
        id:
          type: string
          format: uuid
        type:
          $ref: '#/components/schemas/workType'
        title:
          type: string
        description:
          type: string
        author:
          $ref: '#/components/schemas/person'
        illustrator:
          $ref: '#/components/schemas/person'
        editions:
          type: array
          items:
            $ref: '#/components/schemas/edition'
    person:
      type: object
      properties:
        id:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
    error:
      type: object
      description: RFC 7807 Problem Details for HTTP APIs
      properties:
        type:
          type: string
          format: uri
          description: A URI reference that identifies the problem type
          example: about:blank
        title:
          type: string
          description: A short, human-readable summary of the problem type
          example: Not Found
        status:
          type: integer
          description: The HTTP status code
          example: 404
        detail:
          type: string
          description: A human-readable explanation specific to this occurrence of the problem
          example: Work with id 123e4567-e89b-12d3-a456-426614174000 not found
        instance:
          type: string
          format: uri
          description: A URI reference that identifies the specific occurrence of the problem
          example: http://localhost:8080/api/works/123e4567-e89b-12d3-a456-426614174000
      required:
        - status
